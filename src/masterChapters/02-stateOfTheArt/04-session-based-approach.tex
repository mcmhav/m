% !TEX root = ../../report.tex

\section{Session Based Approach}
    Different ways of personalizing recommendations have been explored earlier in this chapter, such as: collaborative filtering and content based filtering.
    A common issue with these types recommendations is sparsity in the data, which can lead to poor recommendations.
    Through utilizing usage pattern of the user and producing sessions, some of the sparsity gaps can be filled.
    The patterns can help to understand the pre-purchase patterns, products they see and what they buy.
    This information can also produce interesting relationships between products.
    With this the user preferences can be gathered and be used to reduce the search space when recommending product for the user.

% \subsection{E-commerce}
%     About sessions

\subsection{Mining}
    How to gather information on the user.
    The data mining can be split into two main steps~\cite{Cho2002329}:
    \begin{itemize}
        \item \emph{Data Preparation} - In the data preparation step the sessions are built. They are built based on the usage during a single visit to the application, web page or system the user is accessing. It is the sequence of events produced by the user actions during the visit.
        \item \emph{Pattern Discovery} - In the pattern discovery step the system must use the sessions gathered in the previous step to discover association rules, sequential patterns, usage clusters, page clusters, user classification or any other pattern discovery method.
    \end{itemize}

    \subsubsection{Data Preparation} % (fold)
        \label{par:Data_Preparation}
        When a user accesses an application or web page, the system can store the footprints of the user.
        Within these footprints the system can embed information as browser used by user, location of the user, event triggered by user and time stamp.
        This bundle of information is called an event, a the set of event produced by the user during on application or web page visit, is called a session.

    \subsubsection{Pattern Discovery} % (fold)
        \label{par:pattern_discovery}
        \paragraph{Association Rules} % (fold)
            \label{subp:association_rules}
            The association rule describes how item X and Y are coupled, this coupling is the percentage of transactions that contain both item X and item Y.

            One simple way of discovering this association is through the aprior algorithm~\cite{Agrawal:1994:FAM:645920.672836}.

            With this set of rules for the items, item taxonomies can be used to infer knowledge regarding the items.
            For instance; sessions when buying blue skirts often include buying of red shoes.
        % easy example: http://nikhilvithlani.blogspot.no/2012/03/apriori-algorithm-for-data-mining-made.html
        \paragraph{Sequential Patterns} % (fold)
        \label{subp:sequential_patterns}
            The sequential patterns can be used to build Markov models to predict the next step the user will take based on the sequential pattern of the events from the sessions~\cite{Deshpande:2004:SMM:990301.990304}.

            An issue with using the Markov model is that if first-order is being used, the accuracy can be faulty, since the model will not be looking far enough behind.
            Handling this with an higher-order model might solve the inaccuracy due to too low order, but might cause an issue with high state space complexity, and might also reduce coverage.
            Which can be handled through training a set of K different Markov models, with K different orders, All-$K^{th}$-Order Markov model, but the space complexity issue will still be present.

            The Markov model predicts future actions through looking at past actions.
            So for first-order, the model looks at the last event performed to predict the next event of the user.
            The higher the order, the further back the model is looking in the event set and will produce a more complicated model, the higher the order.
            This can be handled through the usage of a selective Markov model~\cite{Deshpande:2004:SMM:990301.990304}

            One issue with the Markov model is that a user will not get predicted new items if the sessions used to predict future actions are only based on the own users sessions.
            One way of making use of the patterns and producing new recommendations is trough matching sequential patterns from users with one-another. \marginpar{something not right}


        \paragraph{Usage Clusters} % (fold)
        \label{subp:usage_clusters}
            The usage clusters are usually built up from the different features of the events in the session.
            Where the features are collected an used to model the user.

            \begin{table}[H]
                \centering
                \begin{tabular}{l|l}
                    \emph{Event features} & \emph{Description} \\ \hline
                    Amount of purchases & - \\ \hline
                    Amount of viewsts & - \\ \hline
                    Amount of wants & - \\ \hline
                    Time on items under the different conditions mentioned above & -\\ \hline
                    Overall average time on items & - \\ \hline
                    Click to buy rate & - \\ \hline
                    Search query~\cite{Zhang:2006:MSE:1135777.1136004} & - \\ \hline
                    What was done before a specific action & - \\ \hline
                    What was done before a specific action & - \\
                \end{tabular}
                \caption[Event Features]{Set of event features used for finding usage clusters and model the users behavior}
                \label{table:uasageCluster}
            \end{table}

        \paragraph{Page Clusters} % (fold)
        \label{subp:page_clusters}
            Page clustering will help the system to understand which pages belong together.
            For instance when searching for Harry Potter, the user might have interest in knowing more about the author J.K. Rowling, and the system might benefit from clustering queries of here with Harry Potter~\cite{Zhang:2006:MSE:1135777.1136004}.

        % \paragraph{User Classification} % (fold)
        % \label{subp:user_classification}

\subsubsection{Session Examples} % (fold)
    \label{par:session_examples}
    \marginpar{Show three common user session patterns (average purchase time, want time and view time)}
    A user session of a user randomly chosen user.
    \begin{lstlisting}
        { "event_id" : "app_started", "product_id" : "NULL", "ts" : NumberLong("1382689141084") }
        { "event_id" : "storefront_clicked", "product_id" : "NULL", "ts" : NumberLong("1382689144152") }
        { "event_id" : "storefront_clicked", "product_id" : "NULL", "ts" : NumberLong("1382689172026") }
        { "event_id" : "storefront_clicked", "product_id" : "NULL", "ts" : NumberLong("1382689179152") }
        { "event_id" : "product_detail_clicked", "product_id" : 2028030, "ts" : NumberLong("1382689192035") }
        { "event_id" : "product_purchase_intended", "product_id" : 2028030, "ts" : NumberLong("1382689197749") }
        { "event_id" : "product_detail_clicked", "product_id" : 2038024, "ts" : NumberLong("1382689263384") }
        { "event_id" : "storefront_clicked", "product_id" : "NULL", "ts" : NumberLong("1382689284693") }
        { "event_id" : "storefront_clicked", "product_id" : "NULL", "ts" : NumberLong("1382689297864") }
        { "event_id" : "storefront_clicked", "product_id" : "NULL", "ts" : NumberLong("1382689322201") }
        { "event_id" : "storefront_clicked", "product_id" : "NULL", "ts" : NumberLong("1382689326804") }
        { "event_id" : "storefront_clicked", "product_id" : "NULL", "ts" : NumberLong("1382689352841") }
        { "event_id" : "product_detail_clicked", "product_id" : 2028032, "ts" : NumberLong("1382689357563") }
        { "event_id" : "product_detail_clicked", "product_id" : 2038025, "ts" : NumberLong("1382689363957") }
    \end{lstlisting}

    purchase time: 14068.69687
    want time: 17859.1539

% ~\cite{Kelly:2003:IFI:959258.959260}


\subsubsection{Multi-Armed Bandit} % (fold)
    \label{par:multi_armed_bandit}
    \marginpar{might be interesting as an most popular approach, suggest the most popular at any one time, belongs with most popular approach}

\subsubsection{Analyzing}
    Analyzing the model of the user

\subsection{Recommending}
    Using the model to help personalizing the recommendation for the user

\subsection{Limitations}
    What are the limitations of a session based approach to recommendations.

